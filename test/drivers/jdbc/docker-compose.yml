services:
  primary:
    image: postgres:18
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_HOST_AUTH_METHOD=trust
      - POSTGRES_DB=postgres
    # command: postgres -c port=5433
    networks:
      - jdbc_regress_net

  # odyssey:
  #   image: odyssey
  #   environment:
  #     - PG_HOST=primary
  #     - PG_PORT=5433
  #     - LOG_CONFIG=yes
  #     - LOG_SESSION=yes
  #     - USER_AUTH_TYPE=none
  #   networks:
  #     - jdbc_regress_net
  #   depends_on:
  #     - primary

  regress_test:
    build:
      dockerfile: ./test/drivers/jdbc/Dockerfile
      context: ../../../
    networks:
      - jdbc_regress_net
    # depends_on:
    #   - odyssey

networks:
  jdbc_regress_net:
    driver: bridge
